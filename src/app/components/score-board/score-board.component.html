<div class="col-12 col-lg-6 py-2 mx-auto">
    <div class="d-flex flex-row justify-content-center">
        <div class="position-absolute top-50 start-50 translate-middle display-1 text-center fw-bold" [@yourTurn]="animationState">{{"SCOREBOARD.YOURTURN" | translate}}</div>
        
        <div class="d-flex flex-column table-headings-width">
            <div class="table-header bg-white table-leftup-round">{{"SCOREBOARD.PLAYERS" | translate}}</div>
            <div class="table-scoreNames table-leftdown-round table-border bg-white" *ngFor="let scoreHeading of scoreBoardHeaders">
                <div *ngIf="scoreHeading === scoreBoardHeaders[6] || scoreHeading === scoreBoardHeaders[7] || scoreHeading === scoreBoardHeaders[17]; else normalScore" class="table-special-scoreNames">
                    {{scoreHeading}}
                </div>
                <ng-template  #normalScore>
                    {{scoreHeading}}
                </ng-template>
            </div>
        </div>
        
        <div class="d-flex flex-column table-column-width" *ngFor="let Player of players">
            <!-- Headers -->
            <div *ngIf="Player.socketId === this.lastPlayer.socketId; else notLastOccurenceHeader" class="table-header table-rightup-round text-truncate bg-white">{{Player.name}}</div>
            <ng-template #notLastOccurenceHeader>
                <div class="table-header text-truncate bg-white">{{Player.name}}</div>
            </ng-template>
            
            <!-- CurrentPlayer = true & socketId match -->
            <div *ngIf="Player.currentPlayer === true && Player.socketId === this.clientPlayer.socketId">
                <div *ngIf="Player.socketId === this.lastPlayer.socketId; else notLastOccurenceTrueMatch">
                    <div class="table-border table-rightdown-round d-flex bg-white" *ngFor="let scoreRow of Player.score.scoreBoard; index as i">
                        {{scoreRow.score}}
                        <span *ngIf="scoreRow.selectable === true && this.diceHit === true && this.possibleScores[i] > 0" class="possible-score">
                            +{{this.possibleScores[i]}}
                        </span>
                        <button *ngIf="scoreRow.selectable === true" type="button" class="scoreboard-btn bi bi-plus ms-auto" (click)="this.setScore(scoreRow.name)"></button>
                    </div>
                </div>
                
                <ng-template #notLastOccurenceTrueMatch>
                    <div class="table-border d-flex bg-white" *ngFor="let scoreRow of Player.score.scoreBoard; index as i">
                        {{scoreRow.score}}
                        <span *ngIf="scoreRow.selectable === true && this.diceHit === true && this.possibleScores[i] > 0" class="possible-score">+{{this.possibleScores[i]}}</span>
                        <button *ngIf="scoreRow.selectable === true" type="button" class="scoreboard-btn bi bi-plus ms-auto" (click)="this.setScore(scoreRow.name)"></button>
                    </div>
                </ng-template>
            </div>

            <!-- CurrentPlayer = true & socketId doesn't match -->
            <div *ngIf="Player.currentPlayer === true && Player.socketId !== this.clientPlayer.socketId">
                <div *ngIf="Player.socketId === this.lastPlayer.socketId; else notLastOccurenceTrueNoMatch">
                    <div class="table-border table-rightdown-round d-flex bg-white" *ngFor="let scoreRow of Player.score.scoreBoard; index as i">
                        {{scoreRow.score}}
                        <span *ngIf="scoreRow.selectable === true && this.diceHit === true && this.possibleScores[i] > 0" class="possible-score">+{{this.possibleScores[i]}}</span>
                    </div>
                </div>
                
                <ng-template #notLastOccurenceTrueNoMatch>
                    <div class="table-border d-flex bg-white" *ngFor="let scoreRow of Player.score.scoreBoard; index as i">
                        {{scoreRow.score}}
                        <span *ngIf="scoreRow.selectable === true && this.diceHit === true && this.possibleScores[i] > 0" class="possible-score">
                            +{{this.possibleScores[i]}}
                        </span>
                    </div>
                </ng-template>
            </div>

            <!-- CurrentPlayer = false & socketId match -->
            <div *ngIf="Player.currentPlayer === false && Player.socketId === this.clientPlayer.socketId">
                <div *ngIf="Player.socketId === this.lastPlayer.socketId; else notLastOccurenceFalseMatch">
                    <div class="scoreboard-not-current-player table-rightdown-round table-border d-flex bg-white" *ngFor="let scoreRow of Player.score.scoreBoard">
                        {{scoreRow.score}}
                        <button *ngIf="scoreRow.selectable === true" type="button" class="scoreboard-btn bi bi-plus ms-auto" [disabled]="!Player.currentPlayer" (click)="this.setScore(scoreRow.name)"></button>
                    </div>
                </div>
                
                <ng-template #notLastOccurenceFalseMatch>
                    <div class="scoreboard-not-current-player table-border d-flex bg-white" *ngFor="let scoreRow of Player.score.scoreBoard">
                        {{scoreRow.score}}
                        <button *ngIf="scoreRow.selectable === true" type="button" class="scoreboard-btn bi bi-plus ms-auto" [disabled]="!Player.currentPlayer" (click)="this.setScore(scoreRow.name)"></button>
                    </div>
                </ng-template>
            </div>
            
            <!-- CurrentPlayer = false & socketId doesn't match -->
            <div *ngIf="Player.currentPlayer === false && Player.socketId !== this.clientPlayer.socketId">
                <div *ngIf="Player.socketId === this.lastPlayer.socketId; else notLastOccurenceFalseNoMatch">
                    <div class="scoreboard-not-current-player table-border table-rightdown-round d-flex bg-white" *ngFor="let scoreRow of Player.score.scoreBoard">
                        {{scoreRow.score}}
                    </div>
                </div>

                <ng-template #notLastOccurenceFalseNoMatch>
                    <div class="scoreboard-not-current-player table-border d-flex bg-white" *ngFor="let scoreRow of Player.score.scoreBoard">
                        {{scoreRow.score}}
                    </div>
                </ng-template>
            </div>
        </div>
    </div>
</div>

<ng-template #results let-modal>
    <div *ngIf="this.players.length >=2">
        <div class="modal-header">
            <h4 class="modal-title">{{'MODAL.RESULT' | translate}}</h4>
            <button type="button" class="btn-close" aria-label="Close" (click)="closeModalAndReset()"></button>
        </div>
        <div class="modal-body">
            <p class="text-center" *ngFor="let Player of this.players; index as i">{{i+1}}. {{Player.name}} - {{Player.score.total.score}}</p>
        </div>
        <div class="modal-footer">
            <button  type="button" class="btn btn-ligt" (click)="closeModalAndReset()">{{"MODAL.CLOSE" | translate}}</button>
        </div>
    </div>
    <div *ngIf="this.players.length === 1">
        <div class="modal-header">
            <h4 class="modal-title">{{'MODAL.RESULT' | translate}}</h4>
            <button type="button" class="btn-close" aria-label="Close" (click)="closeModalAndReset()"></button>
        </div>
        <div class="modal-body">
            <p class="text-center">{{"MODAL.YOUGOT" | translate: {value: this.players[0].score.total.score} }} </p>
        </div>
        <div class="modal-footer">
            <button  type="button" class="btn btn-ligt" (click)="closeModalAndReset()">{{"MODAL.CLOSE" | translate}}</button>
        </div>
    </div>
</ng-template>

